{% extends 'layout.html' %}

{% load staticfiles %}

{% block breadcrumb %}
<li><strong>Students</strong></li>
<li>{{ request.user.profile.school }}</li>
{% endblock %}

{% block content %}
    <!-- widget div-->
    <div>

        <!-- widget edit box -->
        <div class="jarviswidget-editbox">
            <!-- This area used as dropdown edit box -->

        </div>
        <!-- end widget edit box -->

        <!-- widget content -->
        <div class="widget-body no-padding">

            <table id="datatable_fixed_column" class="table table-striped table-bordered" width="100%">

                <thead>
{#                <tr>#}
{#                    <th class="hasinput" style="width:17%">#}
{#                        <input type="text" class="form-control" placeholder="Filter Name"/>#}
{#                    </th>#}
{#                    <th class="hasinput" style="width:18%">#}
{#                        <div class="input-group">#}
{#                            <input class="form-control" placeholder="Filter Admission Number" type="text">#}
{#                        </div>#}
{#                    </th>#}
{#                    <th class="hasinput" style="width:16%">#}
{#                        <input type="text" class="form-control" placeholder="Filter Gender"/>#}
{#                    </th>#}
{#                    <th class="hasinput" style="width:17%">#}
{#                        <input type="text" class="form-control" placeholder="Filter Class"/>#}
{#                    </th>#}
{#                    <th class="hasinput" style="width:16%">#}
{#                        <input type="text" class="form-control" placeholder="Filter Nationality"/>#}
{#                    </th>#}
{#                </tr>#}
                <tr>
                    <th data-class="expand">Name</th>
                    <th>Admission Number</th>
                    <th data-hide="phone">Gender</th>
                    <th data-hide="phone">Class</th>
                    <th data-hide="phone,tablet">Nationality</th>
                    <th data-hide="phone,tablet">Code</th>
                </tr>
                </thead>

                <tbody>

                {% if students %}
                    {% for student in students %}
                        <tr>
                            <td><a href="{% url 'student_details' student.id %}">{{ student.first_name }} {{ student.last_name }}</a></td>
                            <td>{{ student.admission_number }}</td>
                            <td>{{ student.gender }}</td>
                            <td>{{ student.school_class }} {{ student.stream }}</td>
                            <td>{{ student.nationality }}</td>
                            <td>{{ student.code }}</td>
                        </tr>
                    {% endfor %}
                {% endif %}

                </tbody>

            </table>

        </div>
        <!-- end widget content -->

    </div>
    <!-- end widget div -->
{% endblock %}

{% block scripts %}

    <!-- PAGE RELATED PLUGIN(S) -->
    <script src="{% static 'js/plugin/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'js/plugin/datatables/dataTables.colVis.min.js' %}"></script>
    <script src="{% static 'js/plugin/datatables/dataTables.tableTools.min.js' %}"></script>
    <script src="{% static 'js/plugin/datatables/dataTables.bootstrap.min.js' %}"></script>
    <script src="{% static 'js/plugin/datatable-responsive/datatables.responsive.min.js' %}"></script>

    <script>
        var responsiveHelper_dt_basic = undefined;
        var responsiveHelper_datatable_fixed_column = undefined;
        var responsiveHelper_datatable_col_reorder = undefined;
        var responsiveHelper_datatable_tabletools = undefined;

        var breakpointDefinition = {
            tablet: 1024,
            phone: 480
        };

        /* COLUMN FILTER  */
        var otable = $('#datatable_fixed_column').DataTable({
            //"bFilter": false,
            //"bInfo": false,
            //"bLengthChange": false
            //"bAutoWidth": false,
            //"bPaginate": false,
            //"bStateSave": true // saves sort state using localStorage
            "sDom": "<'dt-toolbar'<'col-xs-12 col-sm-6 hidden-xs'f><'col-sm-6 col-xs-12 hidden-xs'<'toolbar'>>r>" +
            "t" +
            "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-xs-12 col-sm-6'p>>",
            "autoWidth": true,
            "oLanguage": {
                "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
            },
            "preDrawCallback": function () {
                // Initialize the responsive datatables helper once.
                if (!responsiveHelper_datatable_fixed_column) {
                    responsiveHelper_datatable_fixed_column = new ResponsiveDatatablesHelper(
                        $('#datatable_fixed_column'), breakpointDefinition);
                }
            },
            "rowCallback": function (nRow) {
                responsiveHelper_datatable_fixed_column.createExpandIcon(nRow);
            },
            "drawCallback": function (oSettings) {
                responsiveHelper_datatable_fixed_column.respond();
            }

        });

        // Apply the filter
        $("#datatable_fixed_column thead th input[type=text]").on('keyup change', function () {

            otable
                .column($(this).parent().index() + ':visible')
                .search(this.value)
                .draw();

        });
        /* END COLUMN FILTER */
    </script>
{% endblock %}